<!DOCTYPE html>
<html lang="en">
<head th:replace="fragment/saron_base :: base(~{::title},~{::link},~{::script})">
    <title>petApet - 회원정보</title>
    <link>
    <script>

        $(function () {
            getMemberProfile();
            $("#closeBtn").click(function () {
                window.close();
            });
            $("#sendMessage").click(function () {
                let _width = '450';
                let _height = '500';
                let _left = Math.ceil(( window.screen.width - _width )/2);
                let _top = Math.ceil(( window.screen.height - _height )/2);
                window.open('/message/'+$("#memberId").text(), '_blank',
                    'width='+ _width +', height='+ _height +', left=' + _left + ', top='+ _top+', location=no,resizeable=no,menubar=no,scrollbars=no,status=no' );
                window.close();
            })
        });
        getMemberProfile = function () {
            $.ajax({
                url: "/getMemberProfile",
                type: "post",
                data: {memberId: $(location).attr('pathname').split("/")[3]},
                dateType: "json",
                success: function (data) {
                    showProfile(data);
                }
                , error: function () {
                    alert('오류가 발생하였습니다.');
                }
            })
        }
        showProfile = function (data) {
            $("#memberImg").attr("src", data.memberImg === "0" ? "/img/profile.jpg" : "/image/" + data.memberImg);
            $("#memberId").text(data.memberId);
            $("#joinDate").text(data.memberJoinDate);
            $("#communityCount").text(data.communityCount);
            $("#commentCount").text(data.commentCount);
        }
    </script>

</head>
<body>
<div class="px-3 bg-dark">
    <span id="communityTitle" class="btn fs-5 px-0 text-white">회원정보</span>
    <button type="button" id="closeBtn" class="btn btn-link p-0 float-end">
        <i class="bi bi-x display-3 text-white"></i>
    </button>
</div>
<div class="mx-5 my-4">
    <div class="col-12">
        <div class="row">
            <div class="col-4 text-end">
                <img id="memberImg" src="" width="80" height="80" class="rounded-3 border border-1"
                     style="object-fit:cover">
            </div>
            <div class="col-8">
                <p id="memberId" class="text-black fs-5 mb-2"></p>
                <button type="button" id="sendMessage" class="btn btn-outline-dark btn-sm">
                    <i class="bi bi-chat-right-text me-1"></i>쪽지
                </button>
            </div>
        </div>
        <div class="row mt-4 text-center text-black">
            <p class="col-4 my-2">가입일</p>
            <p class="col-4 my-2">총 게시물</p>
            <p class="col-4 my-2">총 댓글</p>
        </div>
        <hr class="m-0">
        <div class="row text-center">
            <p id="joinDate" class="col-4 my-2 p-0">test</p>
            <p id="communityCount" class="col-4 my-2">test</p>
            <p id="commentCount" class="col-4 my-2">test</p>
        </div>
        <hr class="m-0">
    </div>
</div>
</body>
</html>